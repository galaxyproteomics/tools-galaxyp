<tool id="build_protein_interaction_maps" name="Build protein interaction maps" version="0.1.0">
    <requirements>
        <requirement type="package" version="3.7.1">python</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        python $__tool_directory__/build_protein_interaction_maps.py 
            #if $input.ids == "text"
                --input="$input.txt"
                --input_type="text"
            #else
                --input="$input.file"
                --ncol="$input.ncol"
                --header="$input.header"
                --input_type="file"
            #end if

            --database=$database.ref
            --dict_path="$__tool_data_path__/${ filter( lambda x: str( x[2] ) == str( $database.species ), $__app__.tool_data_tables['proteore_biogrid_dictionaries'].get_fields() )[0][-1] }"
            --id_type=$database.id_type
            --network_output="$network_output"
            --nodes_output="$nodes_output"

    ]]></command>
    <inputs>
        <conditional name="input">
            <param name="ids" type="select" label="Enter IDs" help="Copy/paste or from a file (e.g. table)">
                <option value="text">Copy/paste your identifiers</option>
                <option value="file" selected="true">Input file containing IDs</option>
            </param>
            <when value="text">
                <param name="txt" type="text" label="Copy/paste IDs" help='IDs must be separated by tab, space or carriage return into the form field, for example: P31946 P62258' >
                    <sanitizer invalid_char="">
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                            <add source="&#x20;" target=""/>
                            <add source="&#xA;" target=""/>
                            <add source="&#xD;" target=""/>
                            <add source="&#x9;" target=""/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt,tabular" label="Select your file" help="" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does file contain header?" />
                <param name="ncol" type="text" value="c1" label="Column number of IDs to map" help='For example, fill in "c1" if it is the first column, "c2" if it is the second column and so on' />                
            </when>
        </conditional>
        <conditional name="database">
            <param name="ref" type="select" label="Select database">
                <option value="biogrid">BioGRID</option>
                <option value="bioplex">Bioplex</option>
                <option value="hu_map">Human protein complex Map (Hu.map)</option>
            </param>
            <when value="biogrid">
                <param name="id_type" type="select" label="Type/source of IDs" optional="false" >
                    <option value="GeneID" >Entrez gene ID</option>
                </param>
                <param name="species" type="select" label="Species">
                    <options from_data_table="proteore_biogrid_dictionaries" />
                    <option value="human"></option>
                    <option value="mouse"></option>
                    <option value="rat"></option>
                </param>
            </when>
            <when value="bioplex">
                <param name="id_type" type="select" label="Type/source of IDs" optional="false" >
                    <option value="GeneID">Entrez gene ID</option>
                    <option value="UniProt-AC" selected="True" >UniProt accession number</option>
                </param>
                <param name="species" type="select" label="Species">
                    <options from_data_table="proteore_bioplex_dictionaries" />
                    <option value="human"></option>
                    <option value="mouse"></option>
                    <option value="rat"></option>
                </param>
            </when>
            <when value="hu_map">
                <param name="id_type" type="select" label="Type/source of IDs" optional="false" >
                    <option value="GeneID" >Entrez gene ID</option>
                </param>
                <param name="species" type="select" label="Species">
                    <options from_data_table="proteore_hu_map_dictionaries" />
                    <option value="human"></option>
                    <option value="mouse"></option>
                    <option value="rat"></option>
                </param>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="network_output" format="tsv" label="Network_${database.ref}_${input.file.name}">
            <filter>input.ids=="file"</filter>
        </data>
        <data name="network_output" format="tsv" label="Network_${database.ref}_from_ids_list">
            <filter>input.ids=="text"</filter>
        </data>
        <data name="nodes_output" format="tsv" label="Nodes_${database.ref}_${input.file.name}">
            <filter>input.ids=="file"</filter>
        </data>
        <data name="nodes_output" format="tsv" label="Nodes_${database.ref}_from_ids_list">
            <filter>input.ids=="text"</filter>
        </data>
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>