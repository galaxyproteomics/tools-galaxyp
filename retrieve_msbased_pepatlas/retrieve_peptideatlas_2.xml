<tool id="retr_pepatlas2" name="Retrieve MS-based information at the peptide level (from Peptide Atlas)" version="0.1.0">
    <description>
    </description>
    <requirements>
        <requirement type="package" version="3.4.1">R</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command interpreter="Rscript">
        $__tool_directory__/retrieve_peptideatlas_2.R
        --input_type="$input.ids"
        #if $input.ids == "list"
            --input="$input.list"
        #else
            --input="$input.file"
            --column_number="$input.ncol"
            --header="$input.header"
        #end if
        --atlas="$atlas"
        #if "Human_Plasma" in str($atlas)
            --atlas_Human_Plasma="$__tool_directory__/PA_Human_Plasma_Peptides_2018.txt"
            --atlas_Human_Plasma_output="PA_Human_Plasma_Peptides_2018_output.txt"
        #end if
        #if "Human_Urine" in str($atlas)
            --atlas_Human_Urine="$__tool_directory__/PA_Human_Urine_Peptides_2018.txt"
            --atlas_Human_Urine_output="PA_Human_Urine_Peptides_2018_output.txt"
        #end if
        #if "Human_Brain" in str($atlas)
            --atlas_Human_Brain="$__tool_directory__/PA_Human_Brain_Peptides_2018.txt"
            --atlas_Human_Brain_output="PA_Human_Brain_Peptides_2018_output.txt"
        #end if
        #if "Human_Heart" in str($atlas)
            --atlas_Human_Heart="$__tool_directory__/PA_Human_Heart_Peptides_2018.txt"
            --atlas_Human_Heart_output="PA_Human_Heart_Peptides_2018_output.txt"
        #end if
        #if "Human_Kidney" in str($atlas)
            --atlas_Human_Kidney="$__tool_directory__/PA_Human_Kidney_Peptides_2018.txt"
            --atlas_Human_Kidney_output="PA_Human_Kidney_Peptides_2018_output.txt"
        #end if
        #if "Human_Liver" in str($atlas)
            --atlas_Human_Liver="$__tool_directory__/PA_Human_Liver_Peptides_2018.txt"
            --atlas_Human_Liver_output="PA_Human_Liver_Peptides_2018_output.txt"
        #end if
        #if "Human_CSF" in str($atlas)
            --atlas_Human_CSF="$__tool_directory__/PA_Human_CSF_Peptides_2018.txt"
            --atlas_Human_CSF_output="PA_Human_CSF_Peptides_2018_output.txt"
        #end if
    </command>

    <inputs>
        <conditional name="input" >
            <param name="ids" type="select" label="Provide your identifiers" help="Copy/paste or ID list from a file (e.g. table)" >
                <option value="list">Copy/paste your identifiers</option>
                <option value="file" selected="true">Input file containing your identifiers</option>
            </param>
            <when value="list" >
                <param name="list" type="text" label="Copy/paste your identifiers" help='IDs must be separated by spaces into the form field, for example: P31946 P62258' >
                    <sanitizer>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt,tabular" label="Choose a file that contains your list of Uniprot IDs" help="" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does your input file contain header?" />
                <param name="ncol" type="text" value="c1" label="The column number of Uniprot IDs to map" help='For example, fill in "c1" if it is the first column, "c2" if it is the second column and so on' />                
            </when>
        </conditional>
        <!-- Peptide Atlas options -->
        <param name="atlas" type="select" display="checkboxes" multiple="true" label="Please select proteomics dataset (sample)">
            <option value="Human_Plasma">Human plasma</option>
            <option value="Human_Urine">Human urine</option>
            <option value="Human_Brain">Human brain</option>
            <option value="Human_Heart">Human heart</option>
            <option value="Human_Kidney">Human kidney</option>
            <option value="Human_Liver">Human liver</option>
            <option value="Human_CSF">Human cerebrospinal fluid</option>
        </param>
    </inputs>

    <outputs>
        <data format="tabular" name="output">
            <discover_datasets pattern="(?P&lt;designation&gt;.+_output).txt" ext="tabular" visible="true" assign_primary_output="true" />
        </data>
    </outputs>

    <tests>
    <test>
        <conditional name="input">
            <param name="ids" value="file"/>
            <param name="file" value="FKW_ID_Converter_Lacombe_et_al_2017_OK.txt"/>
            <param name="column" value="c1"/>
            <param name="header" value="true"/>
        </conditional>

        <param name="atlas" value="Human_Plasma_NonGlyco,Human_Urine,Human_Liver"/> 
      
        <output name="output" file="PeptideAtlas_output.txt"/>
        </test>
    </tests>

    <help><![CDATA[

Given a list of Uniprot accession number the tool allows to retrieve MS-based information 
for each peptide identified for a given protein. Could be of interest for people who wish 
to select peptides for further targeted MS-based experiments (i.e. if the protein is detectable 
in the sample, it will be detected via that peptide).

Input required:
A list of Uniprot accession number (e.g. Q12860) provided either in the form of a file 
(if you choose a file, it is necessary to specify the column where are your Uniprot accession number) 
or in a copy/paste mode. If your input file or list contains other type of IDs, please use the 
ID_Converter tool to convert yours into Uniprot accession number.

Output:

An output is returned for each selected proteomics sample (indicated by the name of the output in the history panel) containing the list of peptides identified for each protein requested with the following additional information:

* peptide_accession: peptide accession number assigned by Peptide Atlas

* peptide_sequence: amino-acidic sequence of the peptide

* n_observations: number of time this peptide has been observed in the sample

* empirical_proteotypic_score: the likelihood for a peptide to be proteotypic (from 0 to 1; the higher the score the higher the proteotypic propensity)

* SSRCalc_relative_hydrophobicity: predicted hydrophobicity computed using sequence-specific retention calculator (SSRCalc) algorithm. A low score indicates a low hydrophobicity.

Data were retrieved from Peptide Atlas release (Jan 2018)

----

**Authors**

T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit, Migale Bioinformatics platform

This work has been partially funded through the French National Agency for Research (ANR) IFB project.

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.
 
    ]]></help>
    <citations>
    </citations>
</tool>

