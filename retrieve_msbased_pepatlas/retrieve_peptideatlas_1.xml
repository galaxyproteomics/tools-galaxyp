<tool id="retr_pepatlas1" name="Number of MS/MS observations in sample (from Peptide Atlas)" version="0.1.0">
    <description>
    </description>
    <requirements>
        <requirement type="package" version="3.4.1">R</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command interpreter="Rscript">
        $__tool_directory__/retrieve_peptideatlas_1.R
        --input_type="$input.ids"
        #if $input.ids == "list"
            --input="$input.list"
        #else
            --input="$input.file"
            --column_number="$input.ncol"
            --header="$input.header"
        #end if
        --atlas="$atlas"
        #if "Human_Plasma_NonGlyco" in str($atlas)
            --atlas_Human_Plasma_NonGlyco="$__tool_directory__/PA_Human_Plasma_Peptides_2018.txt"
        #end if
        #if "Human_Urine" in str($atlas)
            --atlas_Human_Urine="$__tool_directory__/PA_Human_Urine_Peptides_2018.txt"
        #end if
        #if "Human_Brain" in str($atlas)
            --atlas_Human_Brain="$__tool_directory__/PA_Human_Brain_Peptides_2018.txt"
        #end if
        #if "Human_Heart" in str($atlas)
            --atlas_Human_Heart="$__tool_directory__/PA_Human_Heart_Peptides_2018.txt"
        #end if
        #if "Human_Kidney" in str($atlas)
            --atlas_Human_Kidney="$__tool_directory__/PA_Human_Kidney_Peptides_2018.txt"
        #end if
        #if "Human_Liver" in str($atlas)
            --atlas_Human_Liver="$__tool_directory__/PA_Human_Liver_Peptides_2018.txt"
        #end if
        #if "Human_CSF" in str($atlas)
            --atlas_Human_CSF="$__tool_directory__/PA_Human_CSF_Peptides_2018.txt"
        #end if
        --output="$output"
    </command>

    <inputs>
        <conditional name="input" >
            <param name="ids" type="select" label="Provide your identifiers" help="Copy/paste or ID list from a file (e.g. table)" >
                <option value="list">Copy/paste your identifiers</option>
                <option value="file" selected="true">Input file containing your identifiers</option>
            </param>
            <when value="list" >
                <param name="list" type="text" label="Copy/paste your identifiers" help='IDs must be separated by spaces into the form field, for example: P31946 P62258' >
                    <sanitizer>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt,tabular" label="Choose a file that contains your list of Uniprot IDs" help="" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does your input file contain header?" />
                <param name="ncol" type="text" value="c1" label="The column number of Uniprot IDs to map" help='For example, fill in "c1" if it is the first column, "c2" if it is the second column and so on' />                
            </when>
        </conditional>
        <!-- Peptide Atlas options -->
        <param name="atlas" type="select" display="checkboxes" multiple="true" label="Please select proteomics dataset (sample)">
            <option value="Human_Plasma_NonGlyco">Human plasma</option>
            <option value="Human_Urine">Human urine</option>
            <option value="Human_Brain">Human brain</option>
            <option value="Human_Heart">Human heart</option>
            <option value="Human_Kidney">Human kidney</option>
            <option value="Human_Liver">Human liver</option>
            <option value="Human_CSF">Human cerebrospinal fluid</option>
        </param>
    </inputs>

    <outputs>
        <data name="output" format="tabular" label=""/>
    </outputs>

    <tests>
    <test>
        <conditional name="input">
            <param name="ids" value="file"/>
            <param name="file" value="FKW_ID_Converter_Lacombe_et_al_2017_OK.txt"/>
            <param name="column" value="c1"/>
            <param name="header" value="true"/>
        </conditional>

        <param name="atlas" value="Human_Plasma_NonGlyco,Human_Urine,Human_Liver"/> 
      
        <output name="output" file="PeptideAtlas_output.txt"/>
        </test>
    </tests>

    <help><![CDATA[

Given a list of Uniprot accession number this tool indicates the number of times a protein 
has(ve) been observed in a given sample using LC-MS/MS proteomics approach. 
Could be of interest for people who wants to know to what extent a protein 
is detectable (and to roughly estimate its level) in a given sample using proteomics. 
Available human biological samples are the following: brain, heart, kidney, 
liver, plasma, urine and cerebrospinal fluid (CSF). Data were retrieved from 
Peptide Atlas release (Jan 2018).

Input required:

A list of Uniprot accession number (e.g. Q12860) provided either in the form of 
a file (if you choose a file, it is necessary to specify the column where 
are your Uniprot accession number) or in a copy/paste mode. If your input file 
or list contains other type of IDs, please use the ID_Converter tool to convert 
yours into Uniprot accession number.

Output:

Additional columns are created for each selected proteomics sample reporting 
the number of times all peptides corresponding to a protein have been observed by 
LC-MS/MS according to Peptide Atlas. “NA” means that no information has been reported 
suggesting that this protein has not been observed in the sample of interest.

----

**Authors**

T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit, Migale Bioinformatics platform

This work has been partially funded through the French National Agency for Research (ANR) IFB project.

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.
 
    ]]></help>
    <citations>
    </citations>
</tool>

