<tool id="retr_pepatlas" name="Retrieve MS-based information" version="0.1.0">
    <description>
    add MS-based annotation to your protein list from Peptide Atlas
    </description>
    <requirements>
        <requirement type="package" version="3.4.1">R</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command interpreter="Rscript">
        $__tool_directory__/retrieve_peptideatlas.R
        --input_type="$input.ids"
        #if $input.ids == "list"
            --input="$input.list"
        #else
            --input="$input.file"
            --column_number="$input.ncol"
            --header="$input.header"
        #end if
        --atlas="$atlas"
        #if "Human_Plasma_NonGlyco" in str($atlas)
            --atlas_Human_Plasma_NonGlyco="$__tool_directory__/Human_Plasma_NonGlyco_201803_PeptideAtlas.txt"
        #end if
        #if "Human_Urine" in str($atlas)
            --atlas_Human_Urine="$__tool_directory__/Human_Urine_201803_PeptideAtlas.txt"
        #end if
        #if "Human_Brain" in str($atlas)
            --atlas_Human_Brain="$__tool_directory__/Human_Brain_201803_PeptideAtlas.txt"
        #end if
        #if "Human_Heart" in str($atlas)
            --atlas_Human_Heart="$__tool_directory__/Human_Heart_201803_PeptideAtlas.txt"
        #end if
        #if "Human_Kidney" in str($atlas)
            --atlas_Human_Kidney="$__tool_directory__/Human_Kidney_201803_PeptideAtlas.txt"
        #end if
        #if "Human_Liver" in str($atlas)
            --atlas_Human_Liver="$__tool_directory__/Human_Liver_201803_PeptideAtlas.txt"
        #end if
        --output="$output"
    </command>

    <inputs>
        <conditional name="input" >
            <param name="ids" type="select" label="Provide your identifiers" help="Copy/paste or ID list from a file (e.g. table)" >
                <option value="list">Copy/paste your identifiers</option>
                <option value="file" selected="true">Input file containing your identifiers</option>
            </param>
            <when value="list" >
                <param name="list" type="text" label="Copy/paste your identifiers" help='IDs must be separated by spaces into the form field, for example: P31946 P62258' >
                    <sanitizer>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt,tabular" label="Choose a file that contains your list of Uniprot IDs" help="" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does your input file contain header?" />
                <param name="ncol" type="text" value="c1" label="The column number of Uniprot IDs to map" help='For example, fill in "c1" if it is the first column, "c2" if it is the second column and so on' />                
            </when>
        </conditional>
        <!-- Peptide Atlas options -->
        <param name="atlas" type="select" display="checkboxes" multiple="true" label="Please select proteomics dataset (sample)">
            <option value="Human_Plasma_NonGlyco">Human plasma non glycosylated</option>
            <option value="Human_Urine">Human urine</option>
            <option value="Human_Brain">Human brain</option>
            <option value="Human_Heart">Human heart</option>
            <option value="Human_Kidney">Human kidney</option>
            <option value="Human_Liver">Human liver</option>
        </param>
    </inputs>

    <outputs>
        <data name="output" format="tabular" label=""/>
    </outputs>

    <tests>
    <test>
        <conditional name="input">
            <param name="ids" value="file"/>
            <param name="file" value="FKW_ID_Converter_Lacombe_et_al_2017_OK.txt"/>
            <param name="column" value="c1"/>
            <param name="header" value="true"/>
        </conditional>

        <param name="atlas" value="Human_Plasma_NonGlyco,Human_Urine,Human_Liver"/> 
      
        <output name="output" file="PeptideAtlas_output.txt"/>
        </test>
    </tests>

    <help><![CDATA[

**Authors**

T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit, Migale Bioinformatics platform

This work has been partially funded through the French National Agency for Research (ANR) IFB project.

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.
 
    ]]></help>
    <citations>
    </citations>
</tool>
