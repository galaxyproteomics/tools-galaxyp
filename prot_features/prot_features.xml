<tool id="prot_features" name="Protein features" version="0.1.0">
<description>
add biochemical and cellular annotation to your protein list from neXtProt
</description>
<requirements>
  <requirement type="package" version="3.4.1">R</requirement>
</requirements>
<stdio>
  <exit_code range="1:" />
</stdio>
<command><![CDATA[

  #if $inputtype.filetype == "copy_paste":
    
      Rscript $__tool_directory__/protein_features.R 
      --inputtype=copypaste 
      --input='$inputtype.genelist' 
      --nextprot=$__tool_directory__/tool-data/result_nextprot.txt 
      --column=c1 --header=None
      --argsP1='$Nextprot_params.P1' 
      --argsP2='$Nextprot_params.P2' 
      --argsP3='$Nextprot_params.P3' 
      --type='$idtype' 
      --output='$output'  
    
  #end if

  #if $inputtype.filetype == "file_all": 
  
      Rscript $__tool_directory__/protein_features.R 
      --inputtype=tabfile 
      --input='$inputtype.genelist' 
      --nextprot=$__tool_directory__/tool-data/result_nextprot.txt 
      --column='$inputtype.column' --header='$inputtype.header'
      --argsP1='$Nextprot_params.P1' 
      --argsP2='$Nextprot_params.P2' 
      --argsP3='$Nextprot_params.P3' 
      --type='$idtype' 
      --output='$output' 

  #end if
    
]]></command>

<inputs>
  <conditional name="inputtype">
    <param name="filetype" type="select" label="Select your type of input file"> 
      <option value="file_all">Input file containing your identifiers (neXtProt or Uniprot ID)</option>
      <option value="copy_paste">Copy/paste your list of IDs</option> 
    </param>
    <when value="copy_paste">
      <param name="genelist" type="text" label="Enter a list of identifiers"/>
    </when>
    <when value="file_all">
      <param name="genelist" type="data" format="txt,tabular" label="Choose a file that contains your list of IDs" help="This file must imperatively have 1 column filled with IDs consistent with the neXtprot database (Uniprot accession number or neXtProt ID). If this is not the case, please use the ID_Converter tool."/>
      <param name="column" type="text" label="Please specify the column where are your IDs (e.g : Enter c1 for column n°1)" value="c1"/> 
      <param name="header" type="select" label="Does your file have a header?" multiple="false" optional="false"> 
 		      <option value="true" selected="true">Yes</option>
          <option value="false" selected="false">No</option>
      </param>
    </when>
  </conditional>

      <param name="idtype" type="select" label="Type of your input ids" multiple="false" optional="false"> 
 		      <option value="uniprot" selected="true">Uniprot accession number</option>
          <option value="nextprot" selected="false">neXtProt IDs</option>
      </param>
      <section name="Nextprot_params" title="Select features of interest (compulsory step)" expanded="True">
        <param name="P1" type="select" label="Physico-Chemical Features" multiple="true" help="Choose the information you want to add to your data from Nextprot" display="checkboxes" optional="true"> 
          <option value="SeqLength" selected="false">Sequence Length</option>
          <option value="MW" selected="false">Molecular Weight</option>
          <option value="IsoPoint" selected="false">Isoelectric point</option>
          <option value="TMDomains" selected="false">Number of transmembrane domains</option>
          <option value="ProteinExistence" selected="false">Protein Existence (evidence score from 1 to 5)</option>
        </param>

        <param name="P2" type="select" label="Localization" multiple="true" help="Choose the information you want to add to your data from Nextprot" display="checkboxes" optional="true"> 
 		      <option value="Chr" selected="false">Chromosome</option>
 		      <option value="SubcellLocations" selected="false">Subcellular Location</option>
        </param>

        <param name="P3" type="select" label="Diseases information">
          <option value="Diseases">Yes</option>
          <option value="None">No</option>
        </param>
      </section>

</inputs>


<outputs>
  <data name="output" format="tsv" label="Add information from neXtProt"/>
</outputs>

<tests>
  <test>
    <conditional name="inputtype">
      <param name="filetype " value="tabfile"/>
      <param name="genelist" value="FKW_ID_Converter_Lacombe_et_al_2017_OK.txt"/>
      <param name="column" value="c1"/>
      <param name="header" value="true"/>
    </conditional>

    <param name="idtype" value="uniprot"/> 

    <section name="Nextprot_params">
      <param name="P1" value="SeqLength,MW,IsoPoint,TMDomains,ProteinExistence"/> 
      <param name="P2" value="Chr,SubcellLocations"/> 
      <param name="P3" value="Diseases"/> 
    </section>
      
    <output name="output" file="Add_information_from_neXtProt.tsv"/>
  </test>
</tests>

<help><![CDATA[

This tool add annotation (protein features) from neXtProt database (knowledge base on human proteins) to your protein IDs list.

**Input**

Input can be a file containing multiple fields but with **at least one column of Uniprot accession number or neXtProt IDs**. If your input file contains other type of IDs, please use the ID_Converter tool.  

**Databases**

Annotations have been retrieved from the neXtProt database released on 01/08/2017 (Gaudet et  al., 2017) via a REST API (https://academic.oup.com/nar/article/43/D1/D764/2439066#40348985)

**Outputs**

The output is a tabular file. The initial columns are kept and columns are be added according to which annotation you have selected.  

**Authors**

Lisa Peru, T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit, Migale Bioinformatics platform

This work has been partially funded through the French National Agency for Research (ANR) IFB project.

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.
 
    ]]></help>
    <citations>
    </citations>

</tool>
