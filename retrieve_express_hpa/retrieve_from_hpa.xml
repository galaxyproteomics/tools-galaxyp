<tool id="retrieve_from_hpa" name="Retrieve tissue-specific expression data from HPA" version="0.1.0">
<description>
retrieves tissue-specific expression data from HPA (Human Protein Atlas) - no input required
</description>
<requirements>
  <requirement type="package" version="3.4.1">R</requirement>
</requirements>
<stdio>
  <exit_code range="1:" />
</stdio>
<command interpreter="Rscript">
  $__tool_directory__/RetrieveFromHPA.R
  --data_source="$input.data_source"
  #if $input.data_source == "immuno"
    --hpa_ref="$__tool_directory__/HPA.normal.RData"
    --tissue="$input.normal_tissue"
    --level="$input.level"
    --reliability="$input.reliability"
  #else if $input.data_source == "rnaseq"
    --hpa_ref="$__tool_directory__/HPA.rnaTissue.RData"
    --sample="$input.sample"
  #end if
  --output="$output"
</command>

<inputs>
<conditional name="input">
  <param name="data_source" type="select" label="Please choose experimental data source (antibody- or RNAseq-based)">
    <option value="immuno">Expression profiles based on immunohistochemisty</option>
    <option value="rnaseq">RNA levels based on RNA-seq</option>
  </param>
  <when value="immuno">
    <param name="normal_tissue" type="select" label="Select tissue by clicking the dropdown menu below" multiple="True" optional="False">
      <option value="adrenal gland" >Adrenal gland</option>
      <option value="appendix" >Appendix</option>
      <option value="bone marrow" >Bone marrow</option>
      <option value="breast" >Breast</option>
      <option value="bronchus" >Bronchus</option>
      <option value="caudate" >Caudate</option>
      <option value="cerebellum" >Cerebellum</option>
      <option value="cerebral cortex" >Cerebral cortex</option>
      <option value="cervix" >Cervix</option>
      <option value="colon" >Colon</option>
      <option value="duodenum" >Duodenum</option>
      <option value="endometrium 1" >Endometrium 1</option>
      <option value="endometrium 2" >Endometrium 2</option>
      <option value="epididymis" >Epididymis</option>
      <option value="esophagus" >Esophagus</option>
      <option value="fallopian tube" >Fallopian tube</option>
      <option value="gallbladder" >Gallbladder</option>
      <option value="heart muscle" >Heart muscle</option>
      <option value="hippocampus" >Hippocampus</option>
      <option value="kidney" >Kidney</option>
      <option value="liver" >Liver</option>
      <option value="lung" >Lung</option>
      <option value="lymph node" >Lymph node</option>
      <option value="nasopharynx" >Nasopharynx</option>
      <option value="oral mucosa" >Oral mucosa</option>
      <option value="ovary" >Ovary</option>
      <option value="pancreas" >Pancreas</option>
      <option value="parathyroid gland" >Parathyroid gland</option>
      <option value="placenta" >Placenta</option>
      <option value="prostate" >Prostate</option>
      <option value="rectum" >Rectum</option>
      <option value="salivary gland" >Salivary gland</option>
      <option value="seminal vesicle" >Seminal vesicle</option>
      <option value="skeletal muscle" >Skeletal muscle</option>
      <option value="skin 1" >Skin 1</option>
      <option value="skin 2" >Skin 2</option>
      <option value="small intestine" >Small intestine</option>
      <option value="smooth muscle" >Smooth muscle</option>
      <option value="soft tissue 1" >Soft tissue 1</option>
      <option value="soft tissue 2" >Soft tissue 2</option>
      <option value="spleen" >Spleen</option>
      <option value="stomach 1" >Stomach 1</option>
      <option value="stomach 2" >Stomach 2</option>
      <option value="testis" >Testis</option>
      <option value="thyroid gland" >Thyroid gland</option>
      <option value="tonsil" >Tonsil</option>
      <option value="urinary bladder" >Urinary bladder</option>
      <option value="vagina" >Vagina</option>
    </param>
    <param name="level" type="select" label="Expression level" display="checkboxes" multiple="True" optional="False">
      <option value="High" selected="true">High</option>
      <option value="Medium">Medium</option>
      <option value="Low">Low</option>
      <option value="Not detected">Not detected</option>
    </param>
    <param name="reliability" type="select" label="Reliability score" display="checkboxes" multiple="True" optional="False">
      <option value="Enhanced" selected="true">Enhanced</option>
      <option value="Supported" selected="true">Supported</option>
      <option value="Approved" selected="true">Approved</option>
      <option value="Uncertain" selected="true">Uncertain</option>

    </param>
  </when>
  <when value="rnaseq">
    <param name="sample" type="select" label="Keep and annotate genes present in the following tissue(s)" multiple="True" optional="False">
      <option value="adipose tissue">Adipose tissue</option>
      <option value="adrenal gland">Adrenal gland</option>
      <option value="appendix">Appendix</option>
      <option value="bone marrow">Bone marrow</option>
      <option value="breast">Breast</option>
      <option value="cerebral cortex">Cerebral cortex</option>
      <option value="cervix, uterine">Cervix, uterine</option>
      <option value="colon">Colon</option>
      <option value="duodenum">Duodenum</option>
      <option value="endometrium">Endometrium</option>
      <option value="epididymis">Epididymis</option>
      <option value="esophagus">Esophagus</option>
      <option value="fallopian tube">Fallopian tube</option>
      <option value="gallbladder">Gallbladder</option>
      <option value="heart muscle">Heart muscle</option>
      <option value="kidney">Kidney</option>
      <option value="liver">Liver</option>
      <option value="lung">Lung</option>
      <option value="lymph node">Lymph node</option>
      <option value="ovary">Ovary</option>
      <option value="pancreas">Pancreas</option>
      <option value="parathyroid gland">Parathyroid gland</option>
      <option value="placenta">Placenta</option>
      <option value="prostate">Prostate</option>
      <option value="rectum">Rectum</option>
      <option value="salivary gland">Salivary gland</option>
      <option value="seminal vesicle">Seminal vesicle</option>
      <option value="skeletal muscle">Skeletal muscle</option>
      <option value="skin">Skin</option>
      <option value="small intestine">Small intestine</option>
      <option value="smooth muscle">Smooth muscle</option>
      <option value="spleen">Spleen</option>
      <option value="stomach">Stomach</option>
      <option value="testis">Testis</option>
      <option value="thyroid gland">Thyroid gland</option>
      <option value="tonsil">Tonsil</option>
      <option value="rinary bladder">Urinary bladder</option>
    </param>
  </when>
</conditional>
</inputs>

<outputs>
  <data name="output" format="tabular" label=""/>
</outputs>

<tests>
  <test>
    <conditional name="input">
      <param name="data_source" value="immuno"/>
      <param name="normal_tissue" value="lung,ovary"/>
      <param name="level" value="High"/>
      <param name="reliability" value="Approved,Supported"/>
    </conditional>
    <output name="output" file="test.txt"/>
  </test>
</tests>

<help><![CDATA[

.. class:: infomark

**Authors**

T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit, Migale Bioinformatics platform

This work has been partially funded through the French National Agency for Research (ANR) IFB project.

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.

]]></help>

<citations>
</citations>

</tool>
