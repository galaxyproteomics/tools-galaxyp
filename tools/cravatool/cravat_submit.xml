<tool id="cravat_submit" name="CRAVAT Submit, Check, and Retrieve" version="0.1.1">
    <description>| Submits, checks for, and retrieves data for cancer annotation</description>
  <command interpreter="python">
  <![CDATA[
#if $proteo.proteoInput == 'true':
    #if $analysis.type == 'CHASM' or $analysis.type == 'VEST, CHASM':
        cravat_submit.py $input $GRCh $Variant $Gene $Noncoding $Error $analysis.type $analysis.classifier $proBED $proteo.intersectedVariants $proteo.output_vcf $vcf_output
    #else: 
        cravat_submit.py $input $GRCh $Variant $Gene $Noncoding $Error $analysis.type $proBED $proteo.intersectedVariants $proteo.output_vcf $vcf_output 
    #end if
#else:
    #if $analysis.type == 'CHASM' or $analysis.type == 'VEST, CHASM':
        cravat_submit.py $input $GRCh $Variant $Gene $Noncoding $Error $analysis.type $analysis.classifier 
    #else: 
        cravat_submit.py $input $GRCh $Variant $Gene $Noncoding $Error $analysis.type
    #end if
#end if
]]></command>
  
  <inputs>
  
    <param format="tabular" name="input" type="data" label="Source file" help="Accepts transcriptomic or genomic inputs (e.g., tabular, VCF). Additional details can be found below."> </param>
    <conditional name="proteo">
      <param format="tabular" name="proteoInput" type="boolean" checked="false" label="Include proteogenomic input?" help="Source file (first input) must be in genomic input to enable intersection with this proteogenomic input."></param>
      <when value="true">
        <param format="tabular" name="proBED" type="data" label="Peptides with Genomic Coordinates (ProBED Format)"></param>
        <param name="intersectedVariants" type="boolean" checked="false" label="Submit only intersected variants?" help="Submits the intersected portion of the genomic file to CRAVAT's server. Restricting analysis to only intersected variants takes less time but also provides less-comprehensive results."></param>
        <param name="output_vcf" type="boolean" checked="false" label="Output intersected genomic file?" help="The intersected genomic file (e.g., VCF) will be included as a result."></param>
      </when>
    </conditional>
    <conditional name="analysis">
      <param format="tabular" name="type" type="select" label="Analysis Program" help="VEST and CHASM are machine learning methods for predicting the pathogenicity and functional significance of variants, respectively.">
          <option value="None">None</option>
          <option value="VEST">VEST</option>;
          <option value="CHASM">CHASM</option>
          <option value="VEST, CHASM">VEST and CHASM</option>
      </param>
      <when value="CHASM">
        <param format="tabular" name="classifier" type="select" label="CHASM Classifier">
          <option value="Bladder">Bladder</option>
          <option value="Blood-Lymphocyte">Blood-Lymphocyte</option>
          <option value="Blood-Myeloid">Blood-Myeloid</option>
          <option value="Brain-Glioblastoma-Multiforme">Brain-Glioblastoma-Multiforme</option>
          <option value="Brain-Lower-Grade-Glioma">Brain-Lower-Grade-Glioma</option>
          <option value="Breast">Breast</option>
          <option value="Cervix">Cervix</option>
          <option value="Colon">Colon</option>
          <option value="GID">GID</option>
          <option value="Head-and-Neck">Head-and-Neck</option>
          <option value="Kidney-Chromophobe">Kidney-Chromophobe</option>
          <option value="Kidney-Clear-Cell">Kidney-Clear-Cell</option>
          <option value="Kidney-Papillary-Cell">Kidney-Papillary-Cell</option>
          <option value="Liver-Nonviral">Liver-Nonviral</option>
          <option value="Liver-Viral">Liver-Viral</option>
          <option value="Lung-Adenocarcinoma">Lung-Adenocarcinoma</option>
          <option value="Lung-Squamous-Cell">Lung-Squamous-Cell</option>
          <option value="Other">Other</option>
          <option value="Ovary">Ovary</option>
          <option value="Pancreas">Pancreas</option>
          <option value="Prostate-Adenocarcinoma">Prostate-Adenocarcinoma</option>
          <option value="Rectum">Rectum</option>
          <option value="Skin">Skin</option>
          <option value="Stomach">Stomach</option>
          <option value="Thyroid">Thyroid</option>
          <option value="Uterus">Uterus</option>
        </param>
      </when>
      <when value="VEST, CHASM">
        <param format="tabular" name="classifier" type="select" label="CHASM Classifier">
          <option value="Bladder">Bladder</option>
          <option value="Blood-Lymphocyte">Blood-Lymphocyte</option>
          <option value="Blood-Myeloid">Blood-Myeloid</option>
          <option value="Brain-Glioblastoma-Multiforme">Brain-Glioblastoma-Multiforme</option>
          <option value="Brain-Lower-Grade-Glioma">Brain-Lower-Grade-Glioma</option>
          <option value="Breast">Breast</option>
          <option value="Cervix">Cervix</option>
          <option value="Colon">Colon</option>
          <option value="GID">GID</option>
          <option value="Head-and-Neck">Head-and-Neck</option>
          <option value="Kidney-Chromophobe">Kidney-Chromophobe</option>
          <option value="Kidney-Clear-Cell">Kidney-Clear-Cell</option>
          <option value="Kidney-Papillary-Cell">Kidney-Papillary-Cell</option>
          <option value="Liver-Nonviral">Liver-Nonviral</option>
          <option value="Liver-Viral">Liver-Viral</option>
          <option value="Lung-Adenocarcinoma">Lung-Adenocarcinoma</option>
          <option value="Lung-Squamous-Cell">Lung-Squamous-Cell</option>
          <option value="Other">Other</option>
          <option value="Ovary">Ovary</option>
          <option value="Pancreas">Pancreas</option>
          <option value="Prostate-Adenocarcinoma">Prostate-Adenocarcinoma</option>
          <option value="Rectum">Rectum</option>
          <option value="Skin">Skin</option>
          <option value="Stomach">Stomach</option>
          <option value="Thyroid">Thyroid</option>
          <option value="Uterus">Uterus</option>
        </param>
      </when>
    </conditional>
    <param format="tabular" name="GRCh" type="select" label="Genome Reference Consortium Human Build (GRCh)" help="The default human reference genome used for annotation is GRCh38, released on December 24th, 2013 from the Genome Reference Consortium.">
      <option value="GRCh38">GRCh38/hg38</option>
      <option value="GRCh37">GRCh37/hg19</option>
    </param>
  </inputs>
  
  <outputs>
      <collection name="collection" type="list" label="CRAVAT Results on ${on_string}">
        <data format="tabular" label="CRAVAT: Gene Level Annotation Report on ${on_string}" name="Gene" />
        <data format="tabular" label="CRAVAT: Variant Report on ${on_string}" name="Variant" />
        <data format="tabular" label="CRAVAT: Non-coding Variant Report on ${on_string}" name="Noncoding" />
        <data format="tabular" label="CRAVAT: Errors on ${on_string}" name="Error" />
      </collection>
      <data format="vcf" label="Intersected VCF on ${on_string}" name="vcf_output">
        <filter>proteo['proteoInput'] and proteo['output_vcf']</filter>
      </data>
  </outputs>

  <tests>
    <test>
      <param name="input" value="fa_gc_content_input.fa"/>
      <output name="out_file1" file="fa_gc_content_output.txt"/>
    </test>
  </tests>

  <help>
This tool submits, checks for, and retrieves data for cancer annotation from the CRAVAT platform at https://www.cravat.us. 
For additional details on input format, visit this link: http://cravat.us/CRAVAT/help.jsp.

-----

**Input Type Example:**

  CRAVAT Format | *Genomic-coordinate format*

    =====  =====  =========  ======  =========  =========  ====================
    UID    Chr.   Position   Strand  Ref. base  Alt. base  Sample ID (optional)
    =====  =====  =========  ======  =========  =========  ====================
    TR1    chr17  7674188    \-      G          T          TCGA-02-0231
    TR2    chr10  121520166  \-      G          A          TCGA-02-3512
    TR3    chr13  48459831   \+      C          A          TCGA-02-3532
    TR4    chr7   116777451  \+      G          T          TCGA-02-1523
    TR5    chr7   140753336  \-      T          A          TCGA-02-0023
    TR6    chr17  39724745   \+      G          T          TCGA-02-0252
    Ins1   chr17  39724745   \+      \-         T          TCGA-02-0252
    Del1   chr17  39724745   \+      A          \-         TCGA-02-0252
    CSub1  chr2   39644095   \+      ATGCT      GA         TCGA-02-0252
    =====  =====  =========  ======  =========  =========  ====================

  </help>

  <citations>
    <citation type="doi">10.1158/0008-5472.CAN-17-0338</citation>
    <citation type="doi">10.1186/s13059-017-1377-x</citation>
  </citations>

</tool>
