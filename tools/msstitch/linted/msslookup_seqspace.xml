<tool id="msslookup_seqspace" name="Create lookup DB with sequences" version="1.0">
    <description>from FASTA for filtering</description>
    <requirements>
        <requirement type="package" version="2.2">msstitch</requirement>
    </requirements>
    <command>
            <![CDATA[
            msslookup seqspace -i '$input'
            #if $insourcefrag
                --insourcefrag
            #end if
            #if $enzyme.trypsinize == "no"
                --notrypsin
            #elif $enzyme.proline
                --cutproline 
            #end if
            &&
            mv mslookup_db.sqlite '$output'
             ]]>
    </command>
    
    <inputs>
        <param name="input" type="data" format="fasta" label="FASTA database" help="Contains the protein sequences that will be used to create the lookup table" />
        <param name="insourcefrag" type="boolean" label="Use in-source fragmentation option when filtering?" help="Reverses sequences so database can assess with wildcards to detect insource fragmentation" />
	<conditional name="enzyme">
		<param name="trypsinize" type="select" display="radio" label="Trypsinize sequences?" >
			<option selected="true" value="no">No</option> 
			<option value="yes">Yes</option>
	       </param>
	       <when value="yes">
		       <param name="proline" type="boolean" label="Trypsin cuts before a proline residue" help="When enabled this includes peptides from when trypsin cuts before proline, as well as those not cut before proline" />
	      </when> 
      </conditional>
      </inputs>
      <outputs>
	      <data format="sqlite" name="output" />
     </outputs>
     <tests>
	    <test>
		    <param name="input" value="db.fasta" />
		    <param name="insourcefrag" value="true" />
		    <param name="enzyme|trypsinize" value="true" />
		    <param name="enzyme|proline" value="true" />
		   <output name="output" value="seqspace.sql" />
	    </test>
    </tests>
    <help>
	    Creates from a FASTA sequence file tryptic sequences that are stored 
	    in the output file which is an SQLite database. The output can
	    be used to do lookups on to find wether a sequence was found
	    in the FASTA file.
    </help>
</tool>
