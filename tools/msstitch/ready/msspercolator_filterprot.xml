<tool id="msspercolator_filterprot" name="Filter out protein sequences">
    <requirements>
        <requirement type="package" version="2.2">msstitch</requirement>
    </requirements>
    <description>from percolator output</description>
    <command>
	    cp '$lookup' seqdb.sqlite
	    &&
	    msspercolator filterprot -i '$input' -o '$output'
            --fasta '$fasta' --dbfile seqdb.sqlite --minlen $minlength
	    #if $deamidate
	    --deamidate
	    #end if
	    #if $forcetryp
	    --enforce-tryptic
	    #end if
    </command>
    
    <inputs>
        <param name="input" type="data" format="percout" 
            label="Percolator output" />
    <param name="fasta" type="data" format="fasta" label="Protein DB"
	    help="Fasta file with proteins to remove peptide sequences from Percolator data" /> 
    <param name="lookup" type="data" format="mslookupsql" label="Lookup with all peptides"
	    help="Created from protein FASTA, containing all possible peptides of certain length" />
        <param name="minlength" type="integer" label="Minimum length of peptides in experiment that will be filtered. Accidental peptides smaller than this will pass the filter." value="" />
    <param name="deamidate" type="boolean" label="Deamidation" 
	    help="Also filters out peptides that are deamidated and not in the known DB"/>
    <param name="forcetryp" type="boolean" label="Filter out tryptic peptides only"
	    help="Peptides that match protein DB but are not tryptic (K/R before peptide in protein, K/R at peptide C-term) are considered novel" />
    </inputs>
    <outputs>
        <data format="percout" name="output"/>
    </outputs>

    <help>
	    Takes Percolator output files and a protein-sequence-containing database.
	    Peptides from proteins found in the database are filtered out of the
	    percolator-output dataset. 
    </help>

</tool>
