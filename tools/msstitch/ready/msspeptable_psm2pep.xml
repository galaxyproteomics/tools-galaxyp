<tool id="msspeptable_psm2pep" name="Create peptide table">
    <requirements>
        <requirement type="package" version="2.2">msstitch</requirement>
    </requirements>
  
    <description>by filtering from PSM table</description>
    <command>
	    msspeptable psm2pep -i $psmtable -o $output
            #if $fncol
            --spectracol $fncol
            #end if
            #if $isobaric.removeisobaric
            --isobquantcolpattern $isobaric.isobpattern
            #end if
	    --scorecolpattern "$scorecol"
            #if $precurqcolpattern
            --ms1quantcolpattern "$precurqcolpattern"
            #end if
    </command>
    
    <inputs>
        <param name="psmtable" type="data" format="mzidtsv" label="PSM table from MSGF+"/>
        <conditional name="isobaric"> 
          <param name="removeisobaric" type="boolean" label="Remove isobaric quant columns?" help="In case adding processed quant to peptide table later" />
          <when value="true">
            <param name="isobpattern" type="text" label="Pattern to identify isobaric columns" help="Regex, e.g. ^tmt10plex_, plex_" />
          </when>
        </conditional>
        <param name="fncol" type="integer" value="" label="Column number containing spectra file name" optional="true" />
        <param name="scorecol" type="text" label="Regular expression pattern to identify score column" help="E.g. svm"/>
        <param name="precurqcolpattern" type="text" label="Regular expression pattern to identify precursor quant columns" optional="true" help="E.g. area"/>
    </inputs>
    
    <outputs>
        <data format="peptsv" name="output"/>
    </outputs>

    <help>
	    This tool creates a peptide table from a PSM table. It filters the PSM table rows so only one row per
	    peptide sequence remains and retains only the best scoring row by reading the score column. If the PSM table
	    e.g. contains isobaric intensities for the PSMs, these can be stripped and later added to the peptide
	    table in the form of ratios.
    </help>
</tool>
