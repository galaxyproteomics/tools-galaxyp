<tool id="msslookup_spectra" name="Create lookup table with spectra">
    <requirements>
        <requirement type="package" version="2.2">msstitch</requirement>
    </requirements>  
    <description>for correlating quant and ID data</description>
    <command>
	    msslookup spectra --filekeys
            #for $filekey in $spectra.keys()
            '$filekey'
            #end for
            -i
            #for $filekey in $spectra.keys()
            '$spectra[$filekey]'
            #end for
	    --setpatterns 
            #for $pool in $pools
            '${pool.set_identifier}'
            #end for
	    --set_names
            #for $pool in $pools
            '${pool.set_name}'
            #end for
	    &&
	    mv mslookup_db.sqlite '$output'
    </command>
     
    <inputs>
      <param name="spectra" type="data_collection" format="mzml" label="Spectra in mzML" />
      <repeat name="pools" title="Biological sets">
	    <param name="set_identifier" type="text" label="Filename part identifying biological set" 
	    help="Specify part of the input spectra filenames that are unique for each set, e.g set_A."/>
	    <param name="set_name" type="text" label="Nice name for the set" help="e.g. Set #1, Patient 3" />
      </repeat>
    </inputs>
    
    <outputs>
        <data format="mslookupsql" name="output"/>
    </outputs>

    <help>
	    Store some information about the MS2 spectra in an SQLite database. Will later be used
	    to reference identifications to spectra and output e.g. scan number, retention time 
	    which MSGF+ does not use.
    </help>

</tool>
