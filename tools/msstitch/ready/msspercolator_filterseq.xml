<tool id="msspercolator_filterseq" name="Filter novel peptides">
    <requirements>
        <requirement type="package">msstitch</requirement>
    </requirements>
    <description>from multiple Percolator fractions and a non-novel database</description>
    <command>cp '$database' seqdb.sqlite
	    &&
	    msspercolator filterseq -i '$input' -o '$output' --dbfile seqdb.sqlite
	    #if $falloff.value > 0
	    --insourcefrag $falloff
	    #end if
	    #if $deamidate
	    --deamidate
	    #end if
    </command>
    
    <inputs>
        <param name="input" type="data" format="percout" 
            label="Percolator output" />
    <param name="database" type="data" format="mslookupsql" label="known sequences"
	    help="Sqlite DB containing sequences to be ignored. This file can be created
	    by running pycolator searchspacedb." />
    <param name="falloff" value="0" type="integer" label="Max amount of amino acids lost at N-terminal due to in-source fragmentation" 
	   help="Also filters peptides from result that partially match due to having lost residues N-terminally by MS"/>
    <param name="deamidate" type="boolean" label="Deamidation" 
	    help="Also filters out peptides that are deamidated and not in the known DB"/>

    </inputs>
    <outputs>
        <data format="percout" name="output"/>
    </outputs>

    <help>
	    Takes Percolator output files and a peptide-sequence-containing database.
	    Peptide sequences found in the database are filtered out of the
	    percolator-output dataset. 
    </help>
</tool>
