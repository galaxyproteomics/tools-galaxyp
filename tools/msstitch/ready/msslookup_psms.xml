<tool id="msslookup_psms" name="Create lookup table with PSMs">
    <requirements>
        <requirement type="package" version="2.2">msstitch</requirement>
    </requirements>
  
    <description>necessary for protein groups and PSM quantification</description>
    
    <command>
	    cp '$lookup' '$output' 
	    &&
	    msslookup psms -i '$mzpsms' --dbfile '$output'
            #if $speccol
            --spectracol $speccol 
            #end if
            #if $dbase
            --fasta $dbase
            #end if
	    #if $mapfn
	    --map $mapfn
	    #end if
	    #if $decoy
	    --decoy
	    #end if
	    #if $fastadelim
	    --fastadelim $fastadelim
	    #end if
	    #if $genefield
	    --genefield $genefield
	    #end if
    </command>
    <inputs>
      <param name="mzpsms" type="data" format="mzidtsv" label="PSM table" />
      <param name="lookup" type="data" format="mslookupsql" label="Lookup with spectra" />
      <param name="speccol" type="integer" value="2" label="Spectra file column number" />
      <param name="dbase" type="data" format="fasta" label="Fasta database used to search" optional="true"/>
      <param name="fastadelim" type="select" label="FASTA delimiter" optional="true" help="In case FASTA is not ENSEMBL or Uniprot you may be able to use a simple splitter to parse out the gene names. The delimiter is what splits the fields.">
          <option value="pipe">| (pipe)</option>
	  <option value="tab">tab</option>
	  <option value="semicolon">; (semicolon)</option>
      </param>
      <param name="genefield" type="integer" label="Gene field number" optional="true" help="To be used together with FASTA delimiter, this is the number of the field in which the gene name is in. First field is nr. 1" />
      <param name="mapfn" type="data" format="martmap" optional="true" label="Biomart map containing genes/symbols/descriptions" />
      <param name="decoy" type="boolean" label="Is the PSM table a decoy?" help="Only necessary to specify in case a ENSEML fasta and Biomart map are supplied" />
    </inputs>
    
    <outputs>
	<data format="mslookupsql" name="output"/>
    </outputs>

    <help>
	    Stores PSM information (scan, sequence, scores) of identification table in an SQLite db. This can be used when
	    adding data to PSM table like protein groups, quantification, etc. 
    </help>
</tool>
