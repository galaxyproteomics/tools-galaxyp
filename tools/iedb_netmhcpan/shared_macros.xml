<macros>
    <xml name="requirements">
        <requirement type="package" version="3.7">python</requirement>
    </xml>
    <xml name="configfiles">
        <configfile name="entered_alleles"><![CDATA[#slurp
#if $alleles.allelesrc == 'entry'
#if $alleles.allele_text != ''
#for $allele in str($alleles.allele_text).strip().split():
$allele
#end for
#end if
#if $alleles.allele_select != 'None'
#for $allele in str($alleles.allele_select).strip().split(","):
$allele
#end for
#end if
#end if
]]></configfile>
        <configfile name="entered_seqs"><![CDATA[#slurp
#if $sequence.seqsrc == 'entry'
#for $seq in str($sequence.seq_text).strip().split()
$seq
#end for
#end if
]]></configfile>
    </xml>
    <xml name="inputs" token_hla_regex="" token_hla_examples="" token_hlalen_examples="">
        <conditional name="alleles">
           <param name="allelesrc" type="select" label="Alleles">
               <option value="history">From history</option>
               <option value="entry">Entered</option>
           </param>
           <when value="history">
               <param name="allele_file" type="data" format="txt" label="Alleles file">
                   <help>The dataset should have one allele per line. The allele may be followed by an optional comma-separated list of peptide lengths, e.g.: @HLALEN_EXAMPLES@</help>
               </param>
           </when>
           <when value="entry">
               <param name="allele_text" type="text" label="Alleles" optional="true">
                   <help>Enter alleles separated by white space: @HLA_EXAMPLES@  (The peptide lengths may follow each allele: @HLALEN_EXAMPLES@)</help>
               </param>
               <expand macro="allele_list_macro" />
           </when>
        </conditional>
        <param name="length_start" type="integer" optional="false" value="8" label="Peptide length range start"/>
        <param name="length_end" type="integer" optional="false" value="8" label="Peptide length range end"/>
        <conditional name="sequence">
           <param name="seqsrc" type="select" label="Peptide sequences">
               <option value="fasta">Fasta file</option>
               <option value="tabular">From tabular</option>
               <option value="entry">Enter sequences</option>
           </param>
           <when value="fasta">
               <param name="seq_fasta" type="data" format="fasta" label="Peptide Sequence Fasta"/>
           </when>
           <when value="tabular">
               <param name="seq_tsv" type="data" format="tabular" label="Peptide Sequence Tabular"/>
               <param name="pep_col" label="Select column with peptides" type="data_column" numerical="false" data_ref="seq_tsv" />
           </when>
           <when value="entry">
               <param name="seq_text" type="text" label="Peptide Sequence"/>
           </when>
        </conditional>
    </xml>
    <xml name="citations">
       <citation type="doi">10.1093/nar/gku938</citation>
       <citation type="doi">10.1093/nar/gkaa379</citation>
    </xml>
</macros>
