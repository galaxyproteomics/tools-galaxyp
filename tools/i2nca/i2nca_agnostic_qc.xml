<tool id='i2nca_agnostic_qc' name='i2nca Agnostic QC Report ' version='@TOOL_VERSION@+galaxy@GALAXY_VERSION@'>

	<description>
        Create agnostic quality control reports for any kind of .imzML file.
        Different metrics will be visualized as a pdf report. 
    </description>
	
    <macros>
    <import>macros.xml</import>
    </macros>
    
    <requirements>
        <container type='docker'>biocontainers/i2nca:0.3.12_cv1</container>
    </requirements>

    <command detect_errors='exit_code'><![CDATA[
    cp '${infile.extra_files_path}/imzml' indata.imzML &&
    cp '${infile.extra_files_path}/ibd' indata.ibd &&
    i2nca_agnostic_qc 'indata.imzML' './data' 
    ]]></command>

    <inputs>
        <param name='infile' type='data' format='imzml' label='MSI data' help='Load the .imzml file on which the QC should be performed'/>
    </inputs>

    <outputs>
            <data name='AgnosticQC' label='Agnostic QC report on ${on_string}' from_work_dir='data_agnostic_QC.pdf' format='pdf' />
    </outputs>

    <tests>
        <!-- Test 1: QC on pp-->
        <test>
            <expand macro='pp_infile'/>
            <output name='AgnosticQC' file='Agnostic_QC_Report_PP.pdf' compare='sim_size'/>
        </test>

        <!-- Test 2: QC on cc-->
        <test>
            <expand macro='cc_infile'/>
            <output name='AgnosticQC' file='Agnostic_QC_Report_CC.pdf' compare='sim_size'/>
        </test>

        <!-- Test 3: QC on cp-->
        <test>
            <expand macro='cp_infile'/>
            <output name='AgnosticQC' file='Agnostic_QC_Report_CP.pdf' compare='sim_size'/>
        </test>

        <!-- Test 4: QC on pc-->
        <test>
            <expand macro='pc_infile'/>
            <output name='AgnosticQC' file='Agnostic_QC_Report_PC.pdf' compare='sim_size'/>
        </test>

        <!-- Test 45: QC on jpc-->
        <test>
            <expand macro='jpc_infile'/>
            <output name='AgnosticQC' file='Agnostic_QC_Report_jPC.pdf' compare='sim_size'/>
        </test>
    </tests>
    <help><![CDATA[
        @I2NCA_DESCRIPTION@
    
        This tool performs a quality control report generation on any imzml file. 
        In the report, different metrics will be visualized. This report doesn't require any input other that a dataset.
        cool, with docker help
    
        **Input data**
        
    
        @MSIDATA_INPUT_DESCRIPTION@
        
        ]]></help>
        <citations>
            <citation type="bibtex">
                @misc{githubi2nca,
                author = {Jannik Witte},
                title = {i2nca},
                publisher = {GitHub},
                journal = {Github repository},
                url = {https://github.com/cKNUSPeR/i2nca}
            }
            </citation>
            <citation type="bibtex">
                @article{10.1093/gigascience/giab049,
                    author = {Cordes, Jonas and Enzlein, Thomas and Marsching, Christian and Hinze, Marven and Engelhardt, Sandy and Hopf, Carsten and Wolf, Ivo},
                    title = '{M2aiaâ€”Interactive, fast, and memory-efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data}',
                    journal = {GigaScience},
                    volume = {10},
                    number = {7},
                    year = {2021},
                    month = {07},
                    issn = {2047-217X},
                    doi = {10.1093/gigascience/giab049},
                    url = {https://doi.org/10.1093/gigascience/giab049}
                }
            </citation>
        </citations>
</tool>