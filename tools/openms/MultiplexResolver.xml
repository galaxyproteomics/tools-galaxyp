<?xml version='1.0' encoding='UTF-8'?>
<!--This is a configuration file for the integration of a tools into Galaxy (https://galaxyproject.org/). This file was automatically generated using CTDConverter.-->
<!--Proposed Tool Section: [Utilities]-->
<tool id="MultiplexResolver" name="MultiplexResolver" version="@TOOL_VERSION@+galaxy@GALAXY_VERSION@" profile="20.05">
  <description>Completes peptide multiplets and resolves conflicts within them.</description>
  <macros>
    <token name="@EXECUTABLE@">MultiplexResolver</token>
    <import>macros.xml</import>
    <import>macros_autotest.xml</import>
    <import>macros_test.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <command detect_errors="exit_code"><![CDATA[@QUOTE_FOO@
@EXT_FOO@
#import re

## Preprocessing
mkdir in &&
ln -s '$in' 'in/${re.sub("[^\w\-_]", "_", $in.element_identifier)}.$gxy2omsext($in.ext)' &&
#if $in_blacklist:
  mkdir in_blacklist &&
  ln -s '$in_blacklist' 'in_blacklist/${re.sub("[^\w\-_]", "_", $in_blacklist.element_identifier)}.$gxy2omsext($in_blacklist.ext)' &&
#end if
mkdir out &&
#if "out_conflicts_FLAG" in str($OPTIONAL_OUTPUTS).split(',')
  mkdir out_conflicts &&
#end if

## Main program call

set -o pipefail &&
@EXECUTABLE@ -write_ctd ./ &&
python3 '$__tool_directory__/fill_ctd.py' '@EXECUTABLE@.ctd' '$args_json' '$hardcoded_json' &&
@EXECUTABLE@ -ini @EXECUTABLE@.ctd
-in
'in/${re.sub("[^\w\-_]", "_", $in.element_identifier)}.$gxy2omsext($in.ext)'
#if $in_blacklist:
  -in_blacklist
  'in_blacklist/${re.sub("[^\w\-_]", "_", $in_blacklist.element_identifier)}.$gxy2omsext($in_blacklist.ext)'
#end if
-out
'out/output.${gxy2omsext("consensusxml")}'
#if "out_conflicts_FLAG" in str($OPTIONAL_OUTPUTS).split(',')
  -out_conflicts
  'out_conflicts/output.${gxy2omsext("consensusxml")}'
#end if
#if len(str($OPTIONAL_OUTPUTS).split(',')) == 0
  | tee '$stdout'
#end if

## Postprocessing
&& mv 'out/output.${gxy2omsext("consensusxml")}' '$out'
#if "out_conflicts_FLAG" in str($OPTIONAL_OUTPUTS).split(',')
  && mv 'out_conflicts/output.${gxy2omsext("consensusxml")}' '$out_conflicts'
#end if
#if "ctd_out_FLAG" in $OPTIONAL_OUTPUTS
  && mv '@EXECUTABLE@.ctd' '$ctd_out'
#end if]]></command>
  <configfiles>
    <inputs name="args_json" data_style="paths"/>
    <configfile name="hardcoded_json"><![CDATA[{"log": "log.txt", "threads": "\${GALAXY_SLOTS:-1}", "no_progress": true}]]></configfile>
  </configfiles>
  <inputs>
    <param name="in" argument="-in" type="data" format="consensusxml" optional="false" label="Peptide multiplets with assigned sequence information" help=" select consensusxml data sets(s)"/>
    <param name="in_blacklist" argument="-in_blacklist" type="data" format="mzml" optional="true" label="Optional input containing spectral peaks blacklisted during feature detection" help="Needed for generation of dummy features select mzml data sets(s)"/>
    <section name="algorithm" title="Parameters for the algorithm" help="" expanded="false">
      <param name="labels" argument="-algorithm:labels" type="text" optional="true" value="[][Lys8,Arg10]" label="Labels used for labelling the samples" help="[...] specifies the labels for a single sample. For example. . [][Lys8,Arg10]        ... SILAC. [][Lys4,Arg6][Lys8,Arg10]        ... triple-SILAC. [Dimethyl0][Dimethyl6]        ... Dimethyl. [Dimethyl0][Dimethyl4][Dimethyl8]        ... triple Dimethyl. [ICPL0][ICPL4][ICPL6][ICPL10]        ... ICPL">
        <expand macro="list_string_san"/>
      </param>
      <param name="missed_cleavages" argument="-algorithm:missed_cleavages" type="integer" optional="true" min="0" value="0" label="Maximum number of missed cleavages due to incomplete digestion" help="(Only relevant if enzymatic cutting site coincides with labelling site. For example, Arg/Lys in the case of trypsin digestion and SILAC labelling.)"/>
      <param name="mass_tolerance" argument="-algorithm:mass_tolerance" type="float" optional="true" value="0.1" label="Mass tolerance in Da for matching the mass shifts in the detected peptide multiplet to the theoretical mass shift pattern" help=""/>
      <param name="mz_tolerance" argument="-algorithm:mz_tolerance" type="integer" optional="true" value="10" label="m/z tolerance in ppm for checking if dummy feature vicinity was blacklisted" help=""/>
      <param name="rt_tolerance" argument="-algorithm:rt_tolerance" type="integer" optional="true" value="5" label="Retention time tolerance in seconds for checking if dummy feature vicinity was blacklisted" help=""/>
    </section>
    <section name="labels" title="Isotopic labels that can be specified in section 'algorithm:labels'" help="" expanded="false">
      <param name="Arg6" argument="-labels:Arg6" type="float" optional="true" min="0.0" value="6.0201290268" label="Label:13C(6)  |  C(-6) 13C(6)  |  unimod #188" help=""/>
      <param name="Arg10" argument="-labels:Arg10" type="float" optional="true" min="0.0" value="10.0082686" label="Label:13C(6)15N(4)  |  C(-6) 13C(6) N(-4) 15N(4)  |  unimod #267" help=""/>
      <param name="Lys4" argument="-labels:Lys4" type="float" optional="true" min="0.0" value="4.0251069836" label="Label:2H(4)  |  H(-4) 2H(4)  |  unimod #481" help=""/>
      <param name="Lys6" argument="-labels:Lys6" type="float" optional="true" min="0.0" value="6.0201290268" label="Label:13C(6)  |  C(-6) 13C(6)  |  unimod #188" help=""/>
      <param name="Lys8" argument="-labels:Lys8" type="float" optional="true" min="0.0" value="8.0141988132" label="Label:13C(6)15N(2)  |  C(-6) 13C(6) N(-2) 15N(2)  |  unimod #259" help=""/>
      <param name="Leu3" argument="-labels:Leu3" type="float" optional="true" min="0.0" value="3.01883" label="Label:2H(3)  |  H(-3) 2H(3)  |  unimod #262" help=""/>
      <param name="Dimethyl0" argument="-labels:Dimethyl0" type="float" optional="true" min="0.0" value="28.0313" label="Dimethyl  |  H(4) C(2)  |  unimod #36" help=""/>
      <param name="Dimethyl4" argument="-labels:Dimethyl4" type="float" optional="true" min="0.0" value="32.056407" label="Dimethyl:2H(4)  |  2H(4) C(2)  |  unimod #199" help=""/>
      <param name="Dimethyl6" argument="-labels:Dimethyl6" type="float" optional="true" min="0.0" value="34.063117" label="Dimethyl:2H(4)13C(2)  |  2H(4) 13C(2)  |  unimod #510" help=""/>
      <param name="Dimethyl8" argument="-labels:Dimethyl8" type="float" optional="true" min="0.0" value="36.07567" label="Dimethyl:2H(6)13C(2)  |  H(-2) 2H(6) 13C(2)  |  unimod #330" help=""/>
      <param name="ICPL0" argument="-labels:ICPL0" type="float" optional="true" min="0.0" value="105.021464" label="ICPL  |  H(3) C(6) N O  |  unimod #365" help=""/>
      <param name="ICPL4" argument="-labels:ICPL4" type="float" optional="true" min="0.0" value="109.046571" label="ICPL:2H(4)  |  H(-1) 2H(4) C(6) N O  |  unimod #687" help=""/>
      <param name="ICPL6" argument="-labels:ICPL6" type="float" optional="true" min="0.0" value="111.041593" label="ICPL:13C(6)  |  H(3) 13C(6) N O  |  unimod #364" help=""/>
      <param name="ICPL10" argument="-labels:ICPL10" type="float" optional="true" min="0.0" value="115.0667" label="ICPL:13C(6)2H(4)  |  H(-1) 2H(4) 13C(6) N O  |  unimod #866" help=""/>
    </section>
    <expand macro="adv_opts_macro">
      <param name="force" argument="-force" type="boolean" truevalue="true" falsevalue="false" checked="false" label="Overrides tool-specific checks" help=""/>
      <param name="test" argument="-test" type="hidden" optional="true" value="False" label="Enables the test mode (needed for internal use only)" help="">
        <expand macro="list_string_san"/>
      </param>
    </expand>
    <param name="OPTIONAL_OUTPUTS" type="select" optional="true" multiple="true" label="Optional outputs">
      <option value="out_conflicts_FLAG">out_conflicts (Optional output containing peptide multiplets without ID annotation or with conflicting quant/ID information)</option>
      <option value="ctd_out_FLAG">Output used ctd (ini) configuration file</option>
    </param>
  </inputs>
  <outputs>
    <data name="out" label="${tool.name} on ${on_string}: out" format="consensusxml"/>
    <data name="out_conflicts" label="${tool.name} on ${on_string}: out_conflicts" format="consensusxml">
      <filter>OPTIONAL_OUTPUTS is not None and "out_conflicts_FLAG" in OPTIONAL_OUTPUTS</filter>
    </data>
    <data name="ctd_out" format="xml" label="${tool.name} on ${on_string}: ctd">
      <filter>OPTIONAL_OUTPUTS is not None and "ctd_out_FLAG" in OPTIONAL_OUTPUTS</filter>
    </data>
  </outputs>
  <tests>
    <expand macro="autotest_MultiplexResolver"/>
    <expand macro="manutest_MultiplexResolver"/>
  </tests>
  <help><![CDATA[Completes peptide multiplets and resolves conflicts within them.


For more information, visit http://www.openms.de/doxygen/release/2.6.0/html/UTILS_MultiplexResolver.html]]></help>
  <expand macro="references"/>
</tool>
