<tool id="find_pathways" name="find pathways (keggrest)" version="2018.08.22">
    <requirements>
        <requirement type="package" version="1.18.0">bioconductor-keggrest</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        Rscript $__tool_directory__/keggrest.R  
        
        #if $input.ids == "text"
            --id_list="$input.txt"
        #else
            --input="$input.file"
            --id_column="$input.ncol"
            --header="$input.header"  
        #end if
        
        --id_type="$ref_ids.id_type"
        --output="$output1" 
        --nb_pathways="$nb_pathways"
        --ref="$ref_ids.ref_file"

    ]]></command>
    <inputs>
        <conditional name="input" >
            <param name="ids" type="select" label="Provide your identifiers" help="Copy/paste or ID list from a file (e.g. table)" >
                <option value="text">Copy/paste your identifiers</option>
                <option value="file" selected="true">Input file containing your identifiers</option>
            </param>
            <when value="text" >
                <param name="txt" type="text" label="Copy/paste your identifiers" help='IDs must be separated by "," into the form field, for example: P31946,P62258' >
                    <sanitizer invalid_char=''>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt,tabular" label="Select a file that contains your list of IDs" help="" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does your input file contain header?" />
                <param name="ncol" type="text" value="c1" label="The column number of IDs to map" help='For example, fill in "c1" if it is the first column, "c2" if it is the second column and so on' />
            </when>
        </conditional>
        <conditional name="ref_ids">
            <param name="id_type" type="select" label="select your identifiers type :">
                <option value="uniprot">Uniprot Accession number</option>
                <option value="geneID">Entrez gene ID</option>
            </param>
            <when value="uniprot">
                <param name="ref_file" type="select" label="Select species" >
                    <options from_data_table="uniprot_kegg_list"/>
                        <option>Human</option>
                        <option>Mouse</option>
                </param>
            </when>
            <when value="geneID">
                <param name="ref_file" type="select" label="Select species" >
                    <options from_data_table="entrez_kegg_list"/>
                        <option>Human</option>
                        <option>Mouse</option>
                </param>
            </when>
        </conditional>
        <param type="integer" name="nb_pathways" label="Set the number of pathways to keep in result" value="10" help="pathways are sorted by percent of mapping gene by pathway in descending order"/>
    </inputs>
    <outputs>
        <data name="output1" format="tsv" />
    </outputs>
    <help><![CDATA[
        Pathview R script
        Arguments:
        --help                  Print this test
        --input                 tab file
        --id_list               id list ',' separated
        --id_type               type of input ids (uniprot_AC or geneID)
        --id_column             number og column containg ids of interest
        --org                   organism : Hs , Mm, ...
        --nb_pathways           number of pathways to return
        --header                boolean
        --output                output path
        --ref                  ref file (l.hsa.gene.RData, l.hsa.up.RData)

        Example:
        Rscript keggrest.R --input='P31946,P62258' --id_type='uniprot' --id_column 'c1' --header TRUE 

    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubKEGGREST,
  author = {LastTODO, FirstTODO},
  year = {TODO},
  title = {KEGGREST},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/Bioconductor/KEGGREST},
}</citation>
    </citations>
</tool>