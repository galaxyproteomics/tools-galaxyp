<tool id="reactome_analysis" name="Reactome" version="0.1.0">
    <description>queries web service and display pathways
    </description>
    <requirements>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        #if $opt.input == "text"
            python $__tool_directory__/reactome_analysis.py --json "$opt.list" "list" --output "$output" --trash "$trash"
        #else if $opt.input == "file"
            python $__tool_directory__/reactome_analysis.py --json "$opt.file" "file" $opt.header $opt.ncol --output "$output" --trash "$trash"
        #end if
        
    ]]></command>
    <inputs>
        <conditional name="opt">
            <param name="input" type="select" label="Input identifiers (Uniprot accession number (e.g. P01023), Entrez gene ID (e.g.7157) or gene name (e.g. AQP7)" multiple="False" >
                <option value="text">Copy/paste your list of IDs </option>
		        <option value="file" selected="true">Input file containing your identifiers</option>
            </param>
            <when value="text" >
                <param name="list" type="text" label="Enter list of identifiers" >
                    <sanitizer>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                        <mapping initial="none">
                            <add source="&apos;" target="__sq__"/>
                        </mapping>
                    </sanitizer>
                </param>
            </when>
            <when value="file" >
                <param name="file" type="data" format="txt, tabular" label="Input file containing your identifiers" help="Input file is a tab-delimited file containing different information of proteins, such as an output of MaxQuant software" />
                <param name="header" type="boolean" checked="true" truevalue="true" falsevalue="false" label="Does your input file contain header?" />
		        <param type="text" name="ncol" value="c1" label="Please specify the column where you would like to apply the comparison" help ='For example, fill in "c1" if you want to filter the first column' />
            </when>
            
        </conditional>
    </inputs>
    <outputs>
        <data name="output" format="html" label="" />
        <data name="trash" format="tabular" hidden="true" label="Invalid id not send to reactome">
                <discover_datasets pattern="(Reactome_Analysis_Tools_invalid_ID).txt" ext="txt" visible="false" assign_primary_output="false"/>
        </data>
    </outputs>
    <tests>
        <test>
            <conditional name="opt" >
                <param name="input" value="file" />
                <param name="file" value="ID_Converter_FKW_Lacombe_et_al_2017_OK.txt" />
                <param name="header" value="true" />
                <param name="ncol" value="c1" />
            </conditional>
            <output name="output" file="Reactome_Analysis_Tools.html" ftype="html" />
            <!-- <output name="trash" file="Reactome_Analysis_Tools_invalid_ID.txt" ftype="tab" hidden="true" /> -->
        </test>
    </tests>
    <help><![CDATA[
Reactome software provides service of creating diagram representing the relations between the biological processes. This tool allows linking to Reactome web service with pre-loaded data from a list of IDs, a file containing IDs or from a column of a complexed file.

**For the rows that have more than 1 ID, only the first one is taken into account.**

**Supported IDs: Uniprot accession number (e.g. P01023), Entrez gene ID (e.g.7157), gene name (e.g. AQP7). If there is any ID containing invalid characters, it will be removed from the queue and placed in "Invalid identifiers" file.**

-----

.. class:: infomark

**Authors** 

Fabregat et al. 2017 PMID: 29145629 (https://www.ncbi.nlm.nih.gov/pubmed/29145629)

Milacic et al. 2012 PMID:24213504 (https://www.ncbi.nlm.nih.gov/pubmed/24243840)

.. class:: infomark

**Galaxy integration**

T.P. Lien Nguyen, Florence Combes, Yves Vandenbrouck CEA, INSERM, CNRS, Grenoble-Alpes University, BIG Institute, FR

Sandra Dérozier, Olivier Rué, Christophe Caron, Valentin Loux INRA, Paris-Saclay University, MAIAGE Unit,Migale Bioinformatics platform,

Contact support@proteore.org for any questions or concerns about the Galaxy implementation of this tool.
    ]]></help>
    <citations>
    </citations>
</tool>
